!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).MHTML={})}(this,function(t){"use strict";function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O(t,e){return n(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||r()}function a(t){return n(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||r()}function n(t){if(Array.isArray(t))return t}function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var D={};function o(t){return t.replace(/[-[\]{}()*+!<=:?.\/\\^$|#\s,]/g,"\\$&")}function e(t){var e="".concat(t?"(":"","\\d+").concat(t?")":"");return"(".concat(o(D.prefix)).concat(e).concat(o(D.postfix),")")}function i(t){Object.assign(D,t),(t.prefix||t.postfix)&&(D.findChunksRegex=new RegExp(e(),"i"),D.replaceChunkRegex=new RegExp(e(!0),"ig"),D.matchChunkRegex=new RegExp("^".concat(e(!0),"$")))}i({document:global.document,Node:global.Node,parser:global.DOMParser?new global.DOMParser:null,parse:function(t){return D.parser.parseFromString(t,"text/html").body},prefix:"{modulor_html_chunk_".concat(+new Date,":"),postfix:"}",specialTagName:"modulor-dynamic-tag-".concat(+new Date),specialAttributeName:"modulor-chunk-".concat(+new Date),dataAttributeName:"modulor-data-attributes-".concat(+new Date),preventChildRenderingProp:"preventChildRendering",preventAttributeSet:"preventAttributeSet"});function u(){return D.document}var S=function(t){return D.matchChunkRegex.exec(t)},m=function(t){return D.findChunksRegex.test(t)},c=function(t){return"".concat(D.prefix).concat(t).concat(D.postfix)},s=function(t){return t instanceof D.Node},w=function(t,e){return e&&e!==u().body.namespaceURI?u().createElementNS(e,t):u().createElement(t)},R=function(t){return u().createTextNode(t)},k=function(t){return u().createComment(t)},j=function(){return u().createDocumentFragment()};function T(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:R(""),e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:R("");return this.childNodes=[],this.firstChild=null,this.lastChild=null,this.startNode=t,this.stopNode=e,t&&e&&(t.parentNode!==e.parentNode||this.update()),this}function f(t){return void 0!==t}function d(t){return!!t&&("object"==typeof t||E(t))&&E(t.then)}function E(t){return"function"==typeof t}function I(t){return t&&"object"==typeof t&&t.constructor===Object}function l(t){return typeof t==typeof!0}function M(t){return"string"==typeof t}function p(t){return function e(n,r){return d(n)?n.then(function(t){return e(t,r)}):d(r)?r.then(function(t){return e(n,t)}):t(n,r)}}T.prototype.appendChild=function(t){this.stopNode.parentNode&&this.stopNode.parentNode.insertBefore(t,this.stopNode),this.update()},T.prototype.removeChild=function(t){this.stopNode.parentNode.removeChild(t),this.update()},T.prototype.replaceChild=function(t,e){e.parentNode.replaceChild(t,e),this.update()},T.prototype.extractContents=function(){var t=j();return t.appendChild(this.startNode),this.childNodes.reduce(function(t,e){return t.appendChild(e),t},t),t.appendChild(this.stopNode),t},T.prototype.update=function(){this.childNodes=[];for(var t=this.startNode.nextSibling;t&&t!==this.stopNode;t=t.nextSibling)this.childNodes.push(t);this.firstChild=this.childNodes[0],this.lastChild=this.childNodes[this.childNodes.length-1]};var P=1,F=3,L=8,_=new Map;function U(t,e){return t.nodeType===e.nodeType&&(t.tagName&&e.tagName&&t.tagName.toLowerCase()===e.tagName.toLowerCase())}function h(t,e){var n=e.name,r=e.value;if(E(n))n(t,r);else if("style"!==n){if(n in t){l(t[n])&&!1!==r&&t.setAttribute(n,r);try{return void(t[n]=r)}catch(t){}}t.setAttribute(n,r)}else I(r)?Object.assign(t.style,r):t.setAttribute(n,r)}function $(t,e){for(var n=e.attributes,r=t.attributes,o=0;o<r.length;o++)t.removeAttribute(r[o].name);for(var i=[],a=0;a<n.length;a++){var u=n[a];if(E(u))i.push(u(t));else h(t,{name:u.name,value:u.value})}return i}function J(t,n,e){for(var r,o,i=2<arguments.length&&void 0!==e?e:{},a=[],u=i.useDocFragment?j():n,c=t.childNodes,s=function(e){return e?function(t){return n.replaceChild(t,e)}:function(t){return u.appendChild(t)}},f=0,d=0;;f++){var l=c[f],p=n.childNodes[f+d];if(!l&&!p)break;if(l)if(p&&U(l,p))o=p,F===(r=l).nodeType===r.nodeType&&r.textContent===o.textContent||U(l,p)&&(a=a.concat(J(l,p)[0]).concat($(p,l)));else{var h=s(p);if(E(l)){var v=_.get(p);if(!v){var m=(v=new T).startNode;h(v.extractContents()),_.set(m,v)}var g=l(v);g&&a.push(g),v.update(),d+=v.childNodes.length+1;continue}switch(l.nodeType){case F:h(R(l.textContent));break;case L:var N=l.textContent,C=k(N);E(N)&&a.push(N(C)),h(C);break;case P:var y=l.namespaceURI,b=l.tagName,x=w(b.toLowerCase(),y);x[D.preventChildRenderingProp]||(a=a.concat(J(l,x)[0])),a=a.concat($(x,l)),h(x)}}else n.removeChild(p),f--}var A=[];return[function t(e){return a.forEach(function(t){return t(e,A)}),A=e,t},function(){return i.useDocFragment?n.appendChild(u):void 0}]}var g=/<([/]?)([^ />]+)((?:\s+[\w}{:-]+(?:([\s])*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)[ ]*>/gim,N=/([-A-Za-z0-9_}{:]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/gim,C=["table","tr","td","style"];function V(t,e,n){var o=1<arguments.length&&void 0!==e?e:[],r=2<arguments.length?n:void 0;return r?o[r[2]]:t.replace(D.replaceChunkRegex,function(t,e,n){var r=o[n];return f(r)?r:""})}function y(a,u,c){var s=new Map;return[function(t,e){s.set(t,{value:e,updated:(s.get(t)||{}).value!==e,keep:!0})},function(){var o={},i=!1;return s.forEach(function(t,e){var n=t.updated,r=t.value;if(!t.keep)return s.delete(e),i=!0,!c&&u(e,r);n&&(i=!0,c||a(e,r)),M(e)&&(o[e]=r),s.set(e,{value:r,keep:!1})}),[i,o]}]}function b(e){return function(t){return et(t,e)}}function x(T){return function(t){var e=t[D.preventAttributeSet],n=O(y(p(function(n){return function(t,e){return h(n,{name:t,value:e})}}(t)),p(function(e){return function(t){e.removeAttribute(t),l(e[t])&&(e[t]=!1)}}(t)),e),2),w=n[0],R=n[1],r=O(y(p(function(e){return function(t){return t&&e.classList.add(t)}}(t)),p(function(e){return function(t){return t&&e.classList.remove(t)}}(t)),e),2),k=r[0],j=r[1];return function(t){var e={},n=!1;for(var r in T){var o=T[r],i=o.name,a=o.value,u=o.matchName,c=o.matchValue,s=o.nameIsDynamic,f=o.valueIsDynamic,d=s?V(i,t,u):i;if("class"!==d){var l=f?V(a,t,c):a;if(d)if(I(d))for(var p in d)w(p,d[p]);else w(d,l)}else{var h=a.split(" ");for(var v in h){var m=h[v],g=V(m,t,S(m));(M(g)?g.split(" "):[].concat(g||[])).forEach(k)}var N=O(j(),2),C=N[0],y=N[1];n=n||C,e.className=Object.keys(y).join(" ")}}var b=O(R(),2),x=b[0],A=b[1];return[Object.assign(e,A),n||x]}}}function A(o,i){var a,u=S(i);return function(t,e){var n=V(i,t,u),r=V(i,e,u);return a&&n===r?a:a=o(n,r)}}function z(t){for(var e=t.nodeType,n=t.namespaceURI,r=t.textContent,o=t.tagName,i=o===D.specialTagName.toUpperCase()?t.getAttribute(D.specialAttributeName):o,a=[],c=t.getAttribute(D.dataAttributeName),s=c?JSON.parse(c).map(function(t){var e=t.name,n=t.value,r=void 0===n||n;return{name:e,value:r,matchName:S(e),matchValue:S(r),nameIsDynamic:m(e),valueIsDynamic:m(r)}}):[],u=m(c)?[]:s,f=t.childNodes||[],d=function(t){var e=f[t],n=e.textContent,r=e.nodeType;return r===F?(n.split(D.findChunksRegex).forEach(function(e){e&&a.push(m(e)?function(t){return A(b(t),e)}:{nodeType:r,textContent:e})}),"continue"):r===L?(a.push({nodeType:r,textContent:m(n)?function(t){return A(function(e){return function(t){return e.textContent=t}}(t),n)}:n}),"continue"):void a.push(z(e))},l=0;l<f.length;l++)d(l);function p(n){var r=[],t=n[D.preventChildRenderingProp],e="props"in n;if(t){var o=function(a){return function(t){return function(i){return[{children:function(t,e){if(e)return e(i),e;var n=O(J(a,t,{useDocFragment:!0}),2),r=n[0],o=n[1];return r(i),o(),r}},!0]}}}(h);r.push(o(n))}var i=e?E(n.props)?function(t,e){return n.props(t,e)}:function(t,e){return e&&(n.props=t)}:function(){};if(m(c)){var a=x(s);r.push(a(n))}else{var u=s.reduce(function(t,e){var n=e.name,r=e.value,o="class"===n?"className":n;return Object.assign(t,v({},o,r))},{});e&&(r.push(function(){return[u]}),i(u,!0))}return function(c,s){var t=O(r.reduce(function(t,e){var n=O(t,2),r=n[0],o=n[1],i=O(e(c,s),2),a=i[0],u=i[1];return[Object.assign(r,a),o||u]},[{},!1]),2),e=t[0],n=t[1];i(e,n)}}var h={nodeType:e,namespaceURI:n,textContent:r,attributes:u,childNodes:a,tagName:i};return u.push(p),m(i)?function(t){var n=A(function(o){return J({childNodes:[E(o)?function(t){var e,n=b(t),r=(v(e={props:function(t){return n(o(t))}},D.preventAttributeSet,!0),v(e,D.preventChildRenderingProp,!0),e);return p(r)}:Object.assign({},h,{tagName:o})]},t)[0]},i);return function(t,e){n(t,e)(t,e)}}:h}var B,H={};function Z(t){var e=0<arguments.length&&void 0!==t?t:[];if(!e.length)return this;var n,r=function(t){for(var e=5381,n=t.length;n;)e=33*e^t.charCodeAt(--n);return e>>>0}(e.join(c(""))),o=H[r];if(f(o))n=o;else{var i=function(t){var e=a(t),n=e[0];return e.slice(1).reduce(function(t,e,n){var r=c(n);return t.concat(r).concat(e)},n)}(e);n=z(D.parse(function(t){return t.replace(g,function(t,e,n,r,o,i){var a=(r=r.replace(/\/$/,function(){return i="/",""})).match(N);return r=a&&"!--"!==n?" ".concat(D.dataAttributeName,"='").concat(JSON.stringify(a.reduce(function(t,e){var n=O(e.split(/=(.*)/),2),r=n[0],o=n[1];return t.concat({name:r,value:o?o.replace(/(^['"])|(['"]$)/g,"").replace(/'/g,"&apos;"):void 0})},[])),"'"):r,(~C.indexOf(n)||m(n))&&(r=" ".concat(D.specialAttributeName,'="').concat(n.trim(),'"').concat(r),n=D.specialTagName),i?"<".concat(n).concat(r,"></").concat(n,">"):e?"</".concat(n,">"):"<".concat(e).concat(n).concat(r,">")})}(i))),H[r]=n}return[n,r]}var q="function",G="array",K="element",Q="promise",W="undefined",X="text";var Y=new Map;function tt(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function et(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:j(),n=Y.get(e)||{},r=function(t){return E(t)?q:t instanceof Array?G:s(t)?K:d(t)?Q:f(t)?X:W}(t),o=n.lastChunk,i=n.lastRenderedChunkType,a=n.update;if(o===t)return e;if(r===Q)return nt[Q](e,t),e;if(i!==r)tt(e);else if(a){var u=a(t);return E(u)&&(n.update=u),n.lastChunk=t,e}return Y.set(e,{update:nt[r](e,t),lastRenderedChunkType:r,lastChunk:t}),e}var nt=(v(B={},G,function e(n,r){var t=O(J({childNodes:[].concat(r).map(function(t,n){return function(e){return function(t){return et(t[n],e)}}})},n,{useDocFragment:!0}),2),o=t[0],i=t[1];return o(r),i(),function(t){if(t.length!==r.length)return e(n,t);o(t)}}),v(B,W,tt),v(B,X,function(t,e){var n=R(e);return t.appendChild(n),function(t){return n.textContent=t}}),v(B,K,function(e,t){return e.appendChild(t),function(t){1<e.childNodes.length&&Array.prototype.slice.call(e.childNodes,1).forEach(function(t){return e.removeChild(t)}),e.replaceChild(t,e.childNodes[0])}}),v(B,Q,function(e,t){t.then(function(t){e.update(),et(t,e)})}),v(B,q,function(e,t){var n=t(e);return function(t){n=t(e,n)}}),B);function rt(){}t.NodesRange=T,t.configure=i,t.emptyNode=tt,t.html=function(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length,i=new Array(1<e?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];if(!t.length)return this;var r=O(Z(t),2),a=r[0],u=r[1];return function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:j(),e=1<arguments.length?arguments[1]:void 0;if(e&&e.templateId===u)return e(i);var n=O(J(a,t,{useDocFragment:!0}),2),r=n[0],o=n[1];return r(i),o(),r.templateId=u,r}},t.render=et,t.stopNode=rt,Object.defineProperty(t,"__esModule",{value:!0})});
